#include <unordered_map>
#include "content_type.h"

using namespace std;

struct TContentTypes {
    TContentTypes() {
        data["323"] = "text/h323";
        data["*"] = "application/octet-stream";
        data["acx"] = "application/internet-property-stream";
        data["ai"] = "application/postscript";
        data["aif"] = "audio/x-aiff";
        data["aifc"] = "audio/x-aiff";
        data["aiff"] = "audio/x-aiff";
        data["asf"] = "video/x-ms-asf";
        data["asr"] = "video/x-ms-asf";
        data["asx"] = "video/x-ms-asf";
        data["au"] = "audio/basic";
        data["avi"] = "video/x-msvideo";
        data["axs"] = "application/olescript";
        data["bas"] = "text/plain";
        data["bcpio"] = "application/x-bcpio";
        data["bin"] = "application/octet-stream";
        data["bmp"] = "image/bmp";
        data["c"] = "text/plain";
        data["cat"] = "application/vnd.ms-pkiseccat";
        data["cdf"] = "application/x-cdf";
        data["cdf"] = "application/x-netcdf";
        data["cer"] = "application/x-x509-ca-cert";
        data["class"] = "application/octet-stream";
        data["clp"] = "application/x-msclip";
        data["cmx"] = "image/x-cmx";
        data["cod"] = "image/cis-cod";
        data["cpio"] = "application/x-cpio";
        data["crd"] = "application/x-mscardfile";
        data["crl"] = "application/pkix-crl";
        data["crt"] = "application/x-x509-ca-cert";
        data["csh"] = "application/x-csh";
        data["css"] = "text/css";
        data["dcr"] = "application/x-director";
        data["der"] = "application/x-x509-ca-cert";
        data["dir"] = "application/x-director";
        data["dll"] = "application/x-msdownload";
        data["dms"] = "application/octet-stream";
        data["doc"] = "application/msword";
        data["dot"] = "application/msword";
        data["dvi"] = "application/x-dvi";
        data["dxr"] = "application/x-director";
        data["eps"] = "application/postscript";
        data["etx"] = "text/x-setext";
        data["evy"] = "application/envoy";
        data["exe"] = "application/octet-stream";
        data["fif"] = "application/fractals";
        data["flr"] = "x-world/x-vrml";
        data["gif"] = "image/gif";
        data["gtar"] = "application/x-gtar";
        data["gz"] = "application/x-gzip";
        data["h"] = "text/plain";
        data["hdf"] = "application/x-hdf";
        data["hlp"] = "application/winhlp";
        data["hqx"] = "application/mac-binhex40";
        data["hta"] = "application/hta";
        data["htc"] = "text/x-component";
        data["htm"] = "text/html";
        data["html"] = "text/html";
        data["htt"] = "text/webviewhtml";
        data["ico"] = "image/x-icon";
        data["ief"] = "image/ief";
        data["iii"] = "application/x-iphone";
        data["ins"] = "application/x-internet-signup";
        data["isp"] = "application/x-internet-signup";
        data["jfif"] = "image/pipeg";
        data["jpe"] = "image/jpeg";
        data["jpeg"] = "image/jpeg";
        data["jpg"] = "image/jpeg";
        data["js"] = "application/x-javascript";
        data["latex"] = "application/x-latex";
        data["lha"] = "application/octet-stream";
        data["lsf"] = "video/x-la-asf";
        data["lsx"] = "video/x-la-asf";
        data["lzh"] = "application/octet-stream";
        data["m13"] = "application/x-msmediaview";
        data["m14"] = "application/x-msmediaview";
        data["m3u"] = "audio/x-mpegurl";
        data["man"] = "application/x-troff-man";
        data["mdb"] = "application/x-msaccess";
        data["me"] = "application/x-troff-me";
        data["mht"] = "message/rfc822";
        data["mhtml"] = "message/rfc822";
        data["mid"] = "audio/mid";
        data["mny"] = "application/x-msmoney";
        data["mov"] = "video/quicktime";
        data["movie"] = "video/x-sgi-movie";
        data["mp2"] = "video/mpeg";
        data["mp3"] = "audio/mpeg";
        data["mpa"] = "video/mpeg";
        data["mpe"] = "video/mpeg";
        data["mpeg"] = "video/mpeg";
        data["mpg"] = "video/mpeg";
        data["mpp"] = "application/vnd.ms-project";
        data["mpv2"] = "video/mpeg";
        data["ms"] = "application/x-troff-ms";
        data["msg"] = "application/vnd.ms-outlook";
        data["mvb"] = "application/x-msmediaview";
        data["nc"] = "application/x-netcdf";
        data["nws"] = "message/rfc822";
        data["oda"] = "application/oda";
        data["p10"] = "application/pkcs10";
        data["p12"] = "application/x-pkcs12";
        data["p7b"] = "application/x-pkcs7-certificates";
        data["p7c"] = "application/x-pkcs7-mime";
        data["p7m"] = "application/x-pkcs7-mime";
        data["p7r"] = "application/x-pkcs7-certreqresp";
        data["p7s"] = "application/x-pkcs7-signature";
        data["pbm"] = "image/x-portable-bitmap";
        data["pdf"] = "application/pdf";
        data["pfx"] = "application/x-pkcs12";
        data["pgm"] = "image/x-portable-graymap";
        data["pko"] = "application/ynd.ms-pkipko";
        data["pma"] = "application/x-perfmon";
        data["pmc"] = "application/x-perfmon";
        data["pml"] = "application/x-perfmon";
        data["pmr"] = "application/x-perfmon";
        data["pmw"] = "application/x-perfmon";
        data["pnm"] = "image/x-portable-anymap";
        data["pot"] = "application/vnd.ms-powerpoint";
        data["ppm"] = "image/x-portable-pixmap";
        data["pps"] = "application/vnd.ms-powerpoint";
        data["ppt"] = "application/vnd.ms-powerpoint";
        data["prf"] = "application/pics-rules";
        data["ps"] = "application/postscript";
        data["pub"] = "application/x-mspublisher";
        data["qt"] = "video/quicktime";
        data["ra"] = "audio/x-pn-realaudio";
        data["ram"] = "audio/x-pn-realaudio";
        data["ras"] = "image/x-cmu-raster";
        data["rgb"] = "image/x-rgb";
        data["rmi"] = "audio/mid";
        data["roff"] = "application/x-troff";
        data["rtf"] = "application/rtf";
        data["rtx"] = "text/richtext";
        data["scd"] = "application/x-msschedule";
        data["sct"] = "text/scriptlet";
        data["setpay"] = "application/set-payment-initiation";
        data["setreg"] = "application/set-registration-initiation";
        data["sh"] = "application/x-sh";
        data["shar"] = "application/x-shar";
        data["sit"] = "application/x-stuffit";
        data["snd"] = "audio/basic";
        data["spc"] = "application/x-pkcs7-certificates";
        data["spl"] = "application/futuresplash";
        data["src"] = "application/x-wais-source";
        data["sst"] = "application/vnd.ms-pkicertstore";
        data["stl"] = "application/vnd.ms-pkistl";
        data["stm"] = "text/html";
        data["sv4cpio"] = "application/x-sv4cpio";
        data["sv4crc"] = "application/x-sv4crc";
        data["svg"] = "image/svg+xml";
        data["swf"] = "application/x-shockwave-flash";
        data["t"] = "application/x-troff";
        data["tar"] = "application/x-tar";
        data["tcl"] = "application/x-tcl";
        data["tex"] = "application/x-tex";
        data["texi"] = "application/x-texinfo";
        data["texinfo"] = "application/x-texinfo";
        data["tgz"] = "application/x-compressed";
        data["tif"] = "image/tiff";
        data["tiff"] = "image/tiff";
        data["tr"] = "application/x-troff";
        data["trm"] = "application/x-msterminal";
        data["tsv"] = "text/tab-separated-values";
        data["txt"] = "text/plain";
        data["uls"] = "text/iuls";
        data["ustar"] = "application/x-ustar";
        data["vcf"] = "text/x-vcard";
        data["vrml"] = "x-world/x-vrml";
        data["wav"] = "audio/x-wav";
        data["wcm"] = "application/vnd.ms-works";
        data["wdb"] = "application/vnd.ms-works";
        data["wks"] = "application/vnd.ms-works";
        data["wmf"] = "application/x-msmetafile";
        data["wps"] = "application/vnd.ms-works";
        data["wri"] = "application/x-mswrite";
        data["wrl"] = "x-world/x-vrml";
        data["wrz"] = "x-world/x-vrml";
        data["xaf"] = "x-world/x-vrml";
        data["xbm"] = "image/x-xbitmap";
        data["xla"] = "application/vnd.ms-excel";
        data["xlc"] = "application/vnd.ms-excel";
        data["xlm"] = "application/vnd.ms-excel";
        data["xls"] = "application/vnd.ms-excel";
        data["xlt"] = "application/vnd.ms-excel";
        data["xlw"] = "application/vnd.ms-excel";
        data["xof"] = "x-world/x-vrml";
        data["xpm"] = "image/x-xpixmap";
        data["xwd"] = "image/x-xwindowdump";
        data["z"] = "application/x-compress";
        data["zip"] = "application/zip";
    }
    unordered_map<string, string> data;
} ContentTypes;

string ContentTypeByName(const string& filename) {
    if (!filename.empty()) {
        size_t n = filename.rfind('.');
        string extension;
        if (n != string::npos) {
            extension = filename.substr(n + 1);
        } else {
            extension = filename;
        }
        auto it = ContentTypes.data.find(extension);
        if (it != ContentTypes.data.end()) {
            return it->second;
        }
    }
    return "test/plain";
}
